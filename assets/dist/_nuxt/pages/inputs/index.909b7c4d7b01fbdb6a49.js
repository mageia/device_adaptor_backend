webpackJsonp([6],{"97Cl":function(e,t,a){"use strict";var i=a("ueV6"),l=a("GQpR"),r=a("VU/8")(i.a,l.a,!1,null,null,null);r.options.__file="components/lean-form.vue",t.a=r.exports},GQpR:function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{attrs:{model:e.form}},[e.isEditing?a("el-form-item",{attrs:{label:"类型","label-width":e.formLabelWidth}},[a("span",[e._v(e._s(e.currentType))])]):e._e(),e.isEditing?e._e():a("el-form-item",{attrs:{label:"类型","label-width":e.formLabelWidth}},[a("el-select",{attrs:{placeholder:"选择数据源类型"},model:{value:e.form.plugin_name,callback:function(t){e.$set(e.form,"plugin_name",t)},expression:"form.plugin_name"}},e._l(e.inputType,function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})}))],1),e._l(e.form.fields,function(t){return a("el-form-item",{attrs:{label:t.label,"label-width":e.formLabelWidth}},["input"===t.type?a("el-input",{attrs:{autoComplete:"off"},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"item.value"}}):e._e(),"combine"===t.type?[a("el-input",{staticStyle:{width:"80px","margin-right":"10px"},attrs:{autoComplete:"off"},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"item.value"}}),a("el-select",{staticStyle:{width:"70px"},model:{value:t.unit,callback:function(a){e.$set(t,"unit",a)},expression:"item.unit"}},e._l(e.units,function(e){return a("el-option",{key:e,attrs:{label:e,value:e}})}))]:e._e(),"text"===t.type?a("el-input",{attrs:{type:"textarea",autoComplete:"off",rows:10},model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"item.value"}}):e._e()],2)})],2)],1)};i._withStripped=!0;var l={render:i,staticRenderFns:[]};t.a=l},"IJ/Z":function(e,t,a){"use strict";var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-form",{ref:"dynamicValidateForm",staticClass:"demo-dynamic",attrs:{model:e.dynamicValidateForm,"label-width":"100px"}},[a("el-form-item",{attrs:{prop:"email",label:"邮箱",rules:[{required:!0,message:"请输入邮箱地址",trigger:"blur"},{type:"email",message:"请输入正确的邮箱地址",trigger:["blur","change"]}]}},[a("el-input",{model:{value:e.dynamicValidateForm.email,callback:function(t){e.$set(e.dynamicValidateForm,"email",t)},expression:"dynamicValidateForm.email"}})],1),e._l(e.dynamicValidateForm.domains,function(t,i){return a("el-form-item",{key:t.key,attrs:{label:"域名"+i,prop:"domains."+i+".value",rules:{required:!0,message:"域名不能为空",trigger:"blur"}}},[a("el-input",{model:{value:t.value,callback:function(a){e.$set(t,"value",a)},expression:"domain.value"}}),a("el-button",{on:{click:function(a){a.preventDefault(),e.removeDomain(t)}}},[e._v("删除")])],1)}),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submitForm("dynamicValidateForm")}}},[e._v("提交")]),a("el-button",{on:{click:e.addDomain}},[e._v("新增域名")]),a("el-button",{on:{click:function(t){e.resetForm("dynamicValidateForm")}}},[e._v("重置")])],1)],2),a("lean-form",{attrs:{"sample-data":e.sample.inputs},on:{changeformData:e.changeFormData}})],1)};i._withStripped=!0;var l={render:i,staticRenderFns:[]};t.a=l},N5H9:function(e,t,a){"use strict";var i=a("fZjL"),l=a.n(i),r=a("97Cl");t.a={components:{LeanForm:r.a},data:function(){return{dynamicValidateForm:{domains:[{value:""}],email:""},formLabelWidth:"100px",form:{plugin_name:"",unit:"",fields:[]},sample:{controllers:{http:[{Key:"created_at",Label:"创建时间",Default:1542187940586,Type:"none",Order:0},{Key:"address",Label:"监听地址",Default:"0.0.0.0:9999",Type:"input",Order:2}]},inputs:{fake:[{Key:"created_at",Label:"创建时间",Default:1542187940586,Type:"none",Order:0},{Key:"name_override",Label:"数据源名称",Default:"fake",Type:"input",Order:1},{Key:"interval",Label:"采集周期",Default:"3s",Type:"combine",Order:20},{Key:"field_prefix",Label:"测点前缀",Default:"",Type:"input",Order:21},{Key:"field_suffix",Label:"测点前缀",Default:"",Type:"input",Order:22},{Key:"point_map_path",Label:"点表地址",Default:"",Type:"input",Order:100},{Key:"point_map_content",Label:"点表内容",Default:"",Type:"text",Order:101}],http_listener:[{Key:"created_at",Label:"创建时间",Default:1542187940586,Type:"none",Order:0},{Key:"listen_address",Label:"监听地址",Default:"0.0.0.0:19999",Type:"input",Order:1},{Key:"max_body_size",Label:"最大消息体大小",Default:5242880,Type:"input",Order:2},{Key:"max_line_size",Label:"最大文件行数",Default:65536,Type:"input",Order:3},{Key:"read_timeout",Label:"读超时时间",Default:"10s",Type:"combine",Order:4},{Key:"write_timeout",Label:"写超时时间",Default:"10s",Type:"combine",Order:5},{Key:"basic_username",Label:"认证账户",Default:"",Type:"input",Order:6},{Key:"basic_password",Label:"认证密码",Default:"",Type:"input",Order:7}],modbus:[{Key:"created_at",Label:"创建时间",Default:1542187940586,Type:"none",Order:0},{Key:"name_override",Label:"数据源名称",Default:"modbus",Type:"input",Order:1},{Key:"address",Label:"数据源地址",Default:"10.211.55.4:502",Type:"input",Order:2},{Key:"slave_id",Label:"从站地址",Default:1,Type:"input",Order:3},{Key:"interval",Label:"采集周期",Default:"3s",Type:"combine",Order:20},{Key:"field_prefix",Label:"测点前缀",Default:"",Type:"input",Order:21},{Key:"field_suffix",Label:"测点前缀",Default:"",Type:"input",Order:22},{Key:"point_map_path",Label:"点表地址",Default:"",Type:"input",Order:100},{Key:"point_map_content",Label:"点表内容",Default:"",Type:"text",Order:101}],s7:[{Key:"created_at",Label:"创建时间",Default:1542187940586,Type:"none",Order:0},{Key:"name_override",Label:"数据源名称",Default:"s7",Type:"input",Order:1},{Key:"address",Label:"数据源地址",Default:"192.168.0.168",Type:"input",Order:2},{Key:"rack",Label:"机架号",Default:0,Type:"input",Order:3},{Key:"slot",Label:"槽号",Default:1,Type:"input",Order:4},{Key:"interval",Label:"采集周期",Default:"3s",Type:"combine",Order:20},{Key:"field_prefix",Label:"测点前缀",Default:"",Type:"input",Order:21},{Key:"field_suffix",Label:"测点前缀",Default:"",Type:"input",Order:22},{Key:"point_map_path",Label:"点表地址",Default:"",Type:"input",Order:100},{Key:"point_map_content",Label:"点表内容",Default:"",Type:"text",Order:101}]},outputs:{file:[{Key:"created_at",Label:"创建时间",Default:1542187940586,Type:"none",Order:0},{Key:"files",Label:"输出地址",Default:["stdout"],Type:"multi-select",Order:1},{Key:"metric_buffer_limit",Label:"批量上传缓冲区大小",Default:0,Type:"input",Order:100},{Key:"metric_batch_size",Label:"测点批量上传数量",Default:0,Type:"input",Order:101}],redis:[{Key:"created_at",Label:"创建时间",Default:1542187940586,Type:"none",Order:0},{Key:"url_address",Label:"地址URL",Default:"redis://localhost:6379/0",Type:"input",Order:1},{Key:"metric_buffer_limit",Label:"批量上传缓冲区大小",Default:0,Type:"input",Order:100},{Key:"metric_batch_size",Label:"测点批量上传数量",Default:0,Type:"input",Order:101}]}},units:["s","ms"]}},computed:{inputList:function(){return this.sample.inputs.modbus},inputType:function(){return l()(this.sample.inputs)}},methods:{submitForm:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return console.log("error submit!!"),!1;alert("submit!"),console.log(t.dynamicValidateForm)})},resetForm:function(e){this.$refs[e].resetFields()},removeDomain:function(e){var t=this.dynamicValidateForm.domains.indexOf(e);-1!==t&&this.dynamicValidateForm.domains.splice(t,1)},addDomain:function(){this.dynamicValidateForm.domains.push({value:"",key:Date.now()})},formatForm:function(){var e=this;this.inputList.forEach(function(t){"none"!==t.Type&&("interval"===t.Key&&(e.form.unit=/[a-z]*$/.exec(t.Default)[0],t.Default=/^[0-9]*/.exec(t.Default)[0]),e.form.fields.push({key:t.Key,value:t.Default,label:t.Label,type:t.Type}))})},changeFormData:function(e){console.log(e)}},mounted:function(){this.formatForm(),console.log(this.form)}}},uCDt:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("N5H9"),l=a("IJ/Z"),r=a("VU/8")(i.a,l.a,!1,null,null,null);r.options.__file="pages/inputs/index.vue",t.default=r.exports},ueV6:function(e,t,a){"use strict";var i=a("fZjL"),l=a.n(i);t.a={name:"lean-form",props:["sampleData","formData","isEditing","currentType"],data:function(){return{formLabelWidth:"120px",form:{plugin_name:"",fields:[]},units:["s","ms"]}},computed:{dataType:function(){return console.log(this.form.plugin_name),this.form.plugin_name},inputType:function(){return l()(this.sampleData)}},watch:{currentType:function(e,t){console.log(this.formData),this.formatForm()},dataType:function(e,t){this.formatForm()},"form.fields":{handler:function(){console.log(this.form),this.$emit("changeFormData",this.form)},deep:!0}},methods:{formatForm:function(){var e=this;this.form.fields=[];var t=this.isEditing?this.currentType:this.dataType;t&&l()(this.sampleData).length>0&&this.sampleData[t].forEach(function(t,a){if("none"!==t.Type&&"plugin_name"!==t.Key)if("combine"===t.Type){var i=e.isEditing?e.formData[t.Key]:t.Default,l=/[a-z]*$/.exec(i)[0];t.Default=/^[0-9]*/.exec(i)[0],e.form.fields.push({key:t.Key,value:t.Default,label:t.Label,type:t.Type,unit:l})}else{if("text"===t.Type&&!e.isEditing)return;e.form.fields.push({key:t.Key,value:e.isEditing?e.formData[t.Key]:t.Default,label:t.Label,type:t.Type})}})},formChange:function(){console.log("change")}},mounted:function(){var e=this;this.$nextTick(function(){e.formatForm()})}}}});